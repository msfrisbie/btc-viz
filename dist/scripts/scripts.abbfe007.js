"use strict";angular.module("blockchainMonitorApp",["ngAnimate","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","pusher-angular","restangular","blockchainMonitorApp.services.blockchain","blockchainMonitorApp.services.bitstamp"]).config(["$routeProvider","$resourceProvider",function(a,b){b.defaults.stripTrailingSlashes=!1,a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("blockchainMonitorApp").controller("MainCtrl",["$scope","Blockchain","Bitstamp",function(a,b,c){function d(b){a.orderBook=f(b)}function e(b){b=f(b),h(b.bids,a.orderBook.bids),h(b.asks,a.orderBook.asks)}function f(a){return a.bids=a.bids.map(g),a.asks=a.asks.map(g),a}function g(a){return{price:parseFloat(a[0]),quantity:parseFloat(a[1])}}function h(a,b){for(var c=0;c<a.length;c++){for(var d=a[c],e=!1,f=0;f<b.length;f++){var g=b[f];if(g.price===d.price){g.quantity=d.quantity,e=!0;break}if(g.price<d.price){b.splice(f,0,d),e=!0;break}}!e&&d.quantity>0&&(console.log("adding",d),b.push(d))}}c.getOrderBook(d),c.getRTOrderBookDiff(e)}]),angular.module("blockchainMonitorApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("blockchainMonitorApp.services.blockchain",[]).factory("Blockchain",["$q","$rootScope",function(){var a={},b=new WebSocket("wss://ws.blockchain.info/inv");return b.onopen=function(){console.log("Socket has been opened!"),b.send(angular.toJson({op:"unconfirmed_sub"}))},b.onmessage=function(a){console.log("transaction",JSON.parse(a.data))},a}]),angular.module("blockchainMonitorApp.services.bitstamp",[]).factory("Bitstamp",["$pusher","$http","$resource",function(a,b){function c(a){b.get("/bitstamp").success(a)}function d(a){g.bind("data",a)}var e=new Pusher("de504dc5763aeef9ff52"),f=a(e),g=f.subscribe("diff_order_book");return{getOrderBook:c,getRTOrderBookDiff:d}}]);